const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/mock.client-BaE_zJ4y.js","assets/v4-BJ1IUc58.js"])))=>i.map(i=>d[i]);
import{a as p,g as w,h as n,aG as V,j as _,U as c,k as i,c as v,aH as M,a3 as A,_ as R,l as y,X as k,n as g,m as b,p as B,F as O,at as f,r as h}from"./index-WE5xPX2m.js";import{K as I}from"./kit-btn-cBAf5fdj.js";const K={key:"skeleton"},H={key:"content"},L=p({__name:"skeleton-wrapper",props:{loading:{type:Boolean}},setup(t){return(e,a)=>(n(),w(V,{name:"skeleton-fade",mode:"out-in"},{default:_(()=>[e.loading?(n(),c("div",K,[i(e.$slots,"skeleton")])):(n(),c("div",H,[i(e.$slots,"default")]))]),_:3}))}}),U=p({__name:"skeleton",props:{type:{default:void 0},width:{default:"100%"},height:{default:"1.2em"},borderRadius:{default:"4px"}},setup(t){const e=t,a=v(()=>({width:typeof e.width=="number"?`${e.width}px`:e.width,height:typeof e.height=="number"?`${e.height}px`:e.height,borderRadius:e.borderRadius}));return(s,l)=>(n(),c("div",{class:A(["p-skeleton",{"p-skeleton--wave":e.type==="wave"}]),style:M(a.value)}," ‌ ",6))}}),Z=R(U,[["__scopeId","data-v-5738b92b"]]),N={class:"error-placeholder"},F=["src"],z={class:"title"},W={key:0,class:"description"},j=p({__name:"index",props:{title:{default:"Что-то пошло не так"},message:{default:"Произошла непредвиденная ошибка. Пожалуйста, попробуйте позже."},imageSrc:{default:"/images/smth-wrong.png"},actionText:{default:""}},emits:["action"],setup(t,{emit:e}){const a=e;return(s,l)=>(n(),c("div",N,[y("img",{src:s.imageSrc,class:"image",alt:"",height:"180","aria-hidden":"true"},null,8,F),y("h1",z,g(s.title),1),s.message?(n(),c("p",W,g(s.message),1)):k("",!0),s.actionText?(n(),w(b(I),{key:1,variant:"outlined",color:"secondary",class:"action",onClick:l[0]||(l[0]=D=>a("action"))},{default:_(()=>[B(g(s.actionText),1)]),_:1})):k("",!0)]))}}),G=R(j,[["__scopeId","data-v-c634a4b8"]]),x=p({__name:"async-state-wrapper",props:{loading:{type:Boolean,default:!1},error:{},data:{default:null},retryHandler:{type:Function,default:void 0},transition:{default:"none"}},setup(t){return(e,a)=>(n(),w(b(L),{loading:e.loading,class:"async-state-wrapper",name:e.transition},{skeleton:_(()=>[e.loading?i(e.$slots,"loading",{key:0},()=>[a[0]||(a[0]=y("div",null,"Загрузка...",-1))]):k("",!0)]),default:_(()=>[e.error?i(e.$slots,"error",{key:0,error:e.error,retry:e.retryHandler},()=>[O(b(G),{"image-src":"/images/smth-wrong.png",title:"Что-то пошло не так",message:"Произошла ошибка при загрузке данных","action-text":"Попробовать снова",onAction:e.retryHandler},null,8,["onAction"])]):e.data?i(e.$slots,"success",{key:1,data:e.data,retry:e.retryHandler}):i(e.$slots,"empty",{key:2})]),_:3},8,["loading","name"]))}}),T={BASE_URL:"/",DEV:!1,MODE:"production",PROD:!0,SSR:!1,VITE_APP_MOCK_MODE:"true",VITE_APP_TRPC_MODE:"false",VITE_APP_TRPC_URL:"http://localhost:3000/trpc"};function X(t){return T?T[t]:""}let u;const q=window.__TAURI__!==void 0;q?(console.log("DB Service: Using RealDatabaseClient for Tauri build."),u=f(async()=>{const{RealDatabaseClient:t}=await import("./real.client-B_XJUTlz.js");return{RealDatabaseClient:t}},[]).then(({RealDatabaseClient:t})=>new t().initDb())):X("VITE_APP_MOCK_MODE")==="true"?(console.log("DB Service: Web build is using MOCK client."),u=f(async()=>{const{MockDatabaseClient:e}=await import("./mock.client-BaE_zJ4y.js");return{MockDatabaseClient:e}},__vite__mapDeps([0,1])).then(({MockDatabaseClient:e})=>new e().initDb())):(console.log("DB Service: Web build is using TRPC client."),u=f(async()=>{const{TRPCDatabaseClient:e}=await import("./trpc.client-DSaBMHvF.js");return{TRPCDatabaseClient:e}},[]).then(({TRPCDatabaseClient:e})=>new e().initDb()));const J=u;function ee(t){const{fn:e,key:a,immediate:s=!0,initialData:l=null,onSuccess:D,onError:S}=t,E=h(l),o=h("idle"),m=h(null),$=v(()=>o.value==="pending"),C=v(()=>o.value==="success"||o.value==="error"),P=async()=>{o.value="pending",m.value=null;try{const r=await J,d=await e(r);return E.value=d,o.value="success",D?.(d),{data:d,error:null}}catch(r){m.value=r,o.value="error";const d=a?` (key: ${a})`:"";return console.error(`[useDatabase Error]${d}:`,r),S?.(r),{data:null,error:r}}};return s&&P(),{data:E,status:o,error:m,isPending:$,isFinished:C,execute:P}}export{Z as S,x as _,ee as u};
